---
title:  "ìºìŠ¤íŒ… (Casting, í˜•ë³€í™˜)"

categories:
  - Cpp
tags:
  - [Cpp, C++, Casting, static_cast, reinterpret_cast, const_cast, dynamic_cast]

toc: true
toc_sticky: true
 
date: 2023-11-29
last_modified_at: 2023-11-29
---

<br>

> ğŸ¤¯ ì–¸ë¦¬ì–¼ì„ í•˜ê¸° ìœ„í•´ C++ ê¸°ì–µ ë˜ì‚´ë¦¬ê¸° í”„ë¡œì íŠ¸

# ìºìŠ¤íŒ… (Casting, í˜•ë³€í™˜)

- ì•”ì‹œì (implicit) ìºìŠ¤íŒ…
  - ì»´íŒŒì¼ëŸ¬ê°€ í˜•ì„ ë³€í™˜í•´ ì¤Œ
    - ë‹¨, í˜• ë³€í™˜ì´ í—ˆìš©ë˜ê³ 
    - í”„ë¡œê·¸ë˜ë¨¸ê°€ ëª…ì‹œì ìœ¼ë¡œ í˜• ë³€í™˜ì„ ì•ˆ í•  ê²½ìš°
  ```cpp
  int number1 = 3;
  long number2 = number1;       // ì•”ì‹œì  ìºìŠ¤íŒ…
  ```
- ëª…ì‹œì (Explicit) ìºìŠ¤íŒ…
  - í”„ë¡œê·¸ë˜ë¨¸ê°€ í˜• ë³€í™˜ì„ ìœ„í•œ ì½”ë“œ ì§ì ‘ ì‘ì„±
    - static_cast
    - const_cast
    - dynamic_cast (c++98, ëª¨ë˜ c++)
    - reinterpret_cast

## 1. ìŠ¤íƒœí‹± ìºìŠ¤íŒ… static_cast

ì •ì  ìºìŠ¤íŒ….  

```cpp
float number1 = 3.f;
int number2 = static_cast<int>(number1);        // <- ì´ê±°. ê°’ ë³€í™˜
Animal* myPet = new Cat(2, "Coco");
Cat* myCat = static_cast<Cat*>(myPet);          // <- ì´ê±°. í¬ì¸í„° ë³€í™˜
```

- ê°’
  - ë‘ ìˆ«ì í˜• ê°„ì˜ ë³€í™˜
    - ê°’ì„ ìœ ì§€ (ë‹¨, ë°˜ì˜¬ë¦¼ ì˜¤ì°¨ëŠ” ì œì™¸)
    - ì´ì§„ìˆ˜ í‘œê¸°ëŠ” ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ  
  
  ```cpp
  int number1 = 3;
  short number2 = static_cast<short>(number1);

  // int: 3 (0000 0000 0000 0011)
  // 3 (0000 0011)
  // ìˆ˜ëŠ” ë³€í•˜ì§€ ì•ŠìŒ. ë¹„íŠ¸ ìˆ˜ë§Œ ì¤„ì–´ë“¤ ë¿...
  ```

  ```cpp
  float number1 = 3.f;
  int number2 = static_cast<int>(number1);

  // float: 3.f (0100 0000 0100 0000)
  // int: 3 (0000 0000 0000 0011)
  ```
- ê°œì²´ í¬ì¸í„°
  - ë³€ìˆ˜í˜• ì²´í¬ í›„ ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìì‹ í´ë˜ìŠ¤ë¡œ ë³€í™˜
    - ë„ˆë„¤ ë‘˜ì´ ì •ë§ ìƒì† ê´€ê³„ê°€ ìˆëŠ”ì§€? ì²´í¬ í•œë‹¤ëŠ” ê²ƒ
  - ì»´íŒŒì¼ ì‹œì—ë§Œ í˜• ì²´í¬ ê°€ëŠ¥
    - ê·¸ë˜ì„œ ì •ì ì´ë¼ëŠ” ê²ƒ
  - ì‹¤í–‰ ë„ì¤‘ í¬ë˜ì‹œ ê°€ëŠ¥ì„± ìˆìŒ
  - ì˜ˆì‹œ 1
  ```cpp
  Animal* myPet = new Cat(2, "Coco");
  Cat* myCat = static_cast<Cat*>(myPet);        // ë‹¹ì—°íˆ ë¨. ìƒì† ê´€ê³„ë‹ˆê¹Œ.
  Dog* myDog = static_cast<Dog*>(myPet);        // ì»´íŒŒì¼ì€ ë¨.
                                                // ì»´íŒŒì¼ëŸ¬ê°€ ì²´í¬í•˜ëŠ” ê±´ Dogì™€ Animalê°„ì˜ ìƒì† ê´€ê³„ê°€ ìˆëŠëƒëŠ” ê²ƒ ë¿.
                                                // ê·¸ë˜ì„œ ìºìŠ¤íŒ…ì€ í•´ì£¼ëŠ”ë°, myDogì€ ì‚¬ì‹¤ Catì´ë‹ˆê¹Œ
  myDog->GetDogHouseName();                     // Dogì— ìˆëŠ” í•¨ìˆ˜ í˜¸ì¶œ í•´ì£¼ë©´ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆìŒ. í•¨ìˆ˜ ìì²´ê°€ ì—†ìœ¼ë‹ˆ
  ```  
  
  - ì˜ˆì‹œ 2  

  ```cpp
  Animal* myPet = new Cat(2, "Coco");

  House* myHouse = static_cast<House*>(myPet);          // ì»´íŒŒì¼ ì—ëŸ¬
  myHouse->GetAddress();                                // Houseí•˜ê³  Catì€ ì•„ë¬´ëŸ° ìƒì† ê´€ê³„ê°€ ì—†ì–´;
  ```
  

## 2. ë¦¬ì¸í„°í”„ë¦¬íŠ¸ ìºìŠ¤íŒ… (Reinterpret_cast)

interpret : í•´ì„  
ì¦‰ ì¬í•´ì„ í•œë‹¤ëŠ” ê²ƒ.  
ê°€ì¥ ìœ„í—˜í•œ ìºìŠ¤íŒ….  

- ì—°ê´€ ì—†ëŠ” ë‘ í¬ì¸í„° í˜• ì‚¬ì´ì˜ ë³€í™˜ì„ í—ˆìš©
  - Cat* <-> House*
  - char* <-> int*
- í¬ì¸í„°ì™€ í¬ì¸í„° ì•„ë‹Œ ë³€ìˆ˜ ì‚¬ì´ì˜ í˜• ë³€í™˜ì„ í—ˆìš©
  - Cat* <-> unsigned int
- <b>ì´ì§„ìˆ˜ í‘œê¸°ëŠ” ë‹¬ë¼ì§€ì§€ ì•ŠìŒ</b>
  - ì»´í“¨í„°ëŠ” ê²°ê³¼ì ìœ¼ë¡œ ì´ì§„ìˆ˜ë¥¼ ì €ì¥í•  ë¿, ì´ë ‡ê²Œ í•´ì„í•´ë‹¬ë¼ê³  ì½”ë”©ì„ í•˜ëŠ” ê²ƒì´ë‹¤.
  - ê·¸ë˜ì„œ ì´ì§„ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ ë‘” ì±„, Aë¥¼ Bë¡œ í•´ì„í•´ë‹¬ë¼- ê³  í•˜ëŠ” ê²ƒ.

```cpp
int* signedNumber = new int(-10);

unsigned int* unsignedNumber1 = static_cast<unsigned int*>(signedNumber);
// ì»´íŒŒì¼ ì—ëŸ¬. ìœ íš¨í•˜ì§€ ì•Šì€ í˜• ë³€í™˜
// int í¬ì¸í„°ë¥¼ unsigned intí¬ì¸í„°ë¡œ ì½ì–´ë²„ë¦¬ë©´, -10ì´ unsigned int ìµœëŒ€ê°’ì´ ë˜ì–´ë²„ë¦¼. 
// ì™œëƒë©´ signed int ì—ì„œ ë¶€í˜¸ë¹„íŠ¸(ì²«ë²ˆì§¸ ë¹„íŠ¸)ëŠ” -ì¼ ê²½ìš° 1ë¡œ ë˜ì–´ ìˆìœ¼ë‹ˆê¹Œ...
// ì´ì§„ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ ë‘” ì±„ í•´ì„ì´ ë°”ë€ŒëŠ” ê²ƒì´ë¯€ë¡œ, ìµœëŒ€ê°’ì´ ëœë‹¤ ì´ ë§ì„.

unsigned int* unsignedNumber2 = reinterpret_cast<unsigned int*>(signedNumber);
// ì»´íŒŒì¼ ë¨. í•˜ì§€ë§Œ ê°’ì€ ë”ì´ìƒ -10ì´ ì•„ë‹˜! 
// unsigned int ì˜ ìµœëŒ€ê°’ì´ ë˜ì–´ë²„ë¦¼.
```

```cpp
Animal* myPet = new Cat(2, "Coco");
unsigned int myPetAddr = reinterpret_cast<unsigned int>(myPet); // <- ì´ê±°

cout << "" << hex << myPet << endl;
```

## 3. ì»¨ìŠ¤íŠ¸ ìºìŠ¤íŒ… (const_cast)

í•˜ì§€ ë§ì•„ì•¼ í•  ìºìŠ¤íŒ….  
- const cast ë¡œ <b>í˜•ì„ ë°”ê¿€ ìˆœ ì—†ìŒ</b>
- const ë˜ëŠ” volatile ì• íŠ¸ë¦¬ë·°íŠ¸ë¥¼ ì œê±°í•  ë•Œ ì‚¬ìš©

```cpp
void Foo(const Animal* ptr)
{
    Animal* animal = const_cast<Animal*>(ptr);      // <- ì´ê±°. const ë–¼ëŠ”ê±°.
    animal->SetAge(5);
}
```

- í¬ì¸í„° í˜•ì— ì‚¬ìš©í•  ë•Œë§Œ ë§ì´ ë¨
  - ê°’ í˜•ì€ ì–¸ì œë‚˜ ë³µì‚¬ë˜ë‹ˆê¹Œ...
- ê·¼ë° ì“°ì§€ ë§ˆì„¸ìš”
  ```cpp
  void Foo(const char* name)
  {
    char* str = const_cast<char*>(name);    // constë¥¼ ë—€ ë‹¤ìŒ ì²« ê¸€ìë¥¼ ë°”ê¾¸ê³  ìˆëŠ” ì½”ë“œ;;
    *str = 'p';                             // ì˜ëª»ëœ ì½”ë“œ
  }
  ```
- ì–¸ì œ ì“°ëƒë©´... ì¨ë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ constë¥¼ ì œëŒ€ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•Œ
  ```cpp
  void WriteLine(char* ptr);        // ë­”ê°€ ë³„ë¡œì¸ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬
                                    // ì¶œë ¥í•œë‹¤ëŠ” í•¨ìˆ˜ë¼ê³  ê°€ì •í•  ë•Œ, ë‚´ìš©ë¬¼ì´ ë°”ë€Œì§€ ì•Šì•„ì•¼ í•˜ëŠ”ë°
                                    // ê·¸ëŸ° ë³´ì¥ì´ ì—†ìŒ

  void MyWriteLine(const char* ptr) // ë‚´ í”„ë¡œê·¸ë¨ì— ìˆëŠ” í•¨ìˆ˜ ìƒˆë¡œ ì‘ì„±
  {
    WriteLine(const_cast<char*>(ptr));  // constë¡œ ë°›ì•„ì„œ ë–¼ê³  ë„˜ê²¨ì£¼ë©´ ëœë‹¤
  }
  ```


```cpp
Animal* myPet = new Cat(2, "Coco");
const Animal* petPtr = myPet;

Animal* myAnimal1 = (Animal*)petPtr;    // const ë–¼ì¤˜! ê·¸ëƒ¥ Animal* ë¡œ ë°”ê¿€ë˜!
                                        // ì»´íŒŒì¼ ê°€ëŠ¥

Cat* myCat1 = (Cat*)petPtr;             // ë‚˜ Cat*ìœ¼ë¡œ ë°”ê¿€ë˜! 
                                        //ì»´íŒŒì¼ ê°€ëŠ¥

Animal* myAnimal2 = const_cast<Animal*>(petPtr);    // Animalë¡œ ë°”ê¿€ê±´ë° const_cast ì‚¬ìš©í• ë˜!
                                                    // ì»´íŒŒì¼ ê°€ëŠ¥. const ë–¼ëŠ” ê±°ë‹ˆê¹Œ ë­...

Cat* myCat2 = const_cast<Cat*>(petPtr);           // Catìœ¼ë¡œ ë°”ê¿€ê±´ë° const_cast ì‚¬ìš©í• ë˜!
                                                  // ì»´íŒŒì¼ ì—ëŸ¬. í˜• ë³€í™˜ í—ˆìš© ì•ˆí•¨! static_cast ì¨ì•¼ í•¨.
```


## 4. ë™ì  ìºìŠ¤íŒ… (dynamic_cast)

- ì‹¤í–‰ ì¤‘ì— í˜•ì„ íŒë‹¨
- í¬ì¸í„° ë˜ëŠ” ì°¸ì¡° í˜•ì„ ìºìŠ¤íŒ… í•  ë•Œë§Œ ì“¸ ìˆ˜ ìˆìŒ.
- í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ìì‹í˜•ìœ¼ë¡œ ìºìŠ¤íŒ…í•˜ë ¤ í•˜ë©´ NULL ë°˜í™˜
  - ë”°ë¼ì„œ static_castë³´ë‹¤ ì•ˆì „!
- í•˜ì§€ë§Œ ì´ê±¸ ì“°ë ¤ë©´ ì»´íŒŒì¼ ì¤‘ì— RTTI(ì‹¤ì‹œê°„ íƒ€ì…ì •ë³´)ë¥¼ ì¼œì•¼ í•œë‹¤.
  - í‚¨ë‹¤ë©´ typeIDë¥¼ ë°›ì•„ì˜´. 
  - ì¼œì§€ ì•Šìœ¼ë©´ static_castì™€ ë˜‘ê°™ì´ ì‘ë™.
  - ê·¼ë° ê¸°ë³¸ì ìœ¼ë¡œ c++ í”„ë¡œì íŠ¸ì—ì„œ RTTIë¥¼ ë„ëŠ” ê²ƒì´ ë³´í†µ...
    - c++ í”„ë¡œì íŠ¸ì—ì„  ì„±ëŠ¥ì„ ì¤‘ìš”ì‹œ í•˜ë¯€ë¡œ. ì´ê±° ëŠë¦¼.
  - ê·¸ë˜ì„œ ì§ì ‘ RTTIë¥¼ êµ¬í˜„í•˜ê¸°ë„ í•¨.
    - ëª‡ëª‡ ì˜¤ë¸Œì íŠ¸ì— ëŒ€í•´ì„œ ë¶€ëª¨ í´ë˜ìŠ¤ì— mType ì´ëŸ°ì‹ìœ¼ë¡œ ë„£ì–´ë†“ê³ ,
  GetType() í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ íƒ€ì… ë¹„êµë¥¼ í•˜ë©´ ëœë‹¤.

```cpp
Animal* myPet = new Cat();

// ì»´íŒŒì¼ ê°€ëŠ¥, NULL ë°˜í™˜
Dog* myDog = dynamic_cast<Dog*>(myPet);
// static_cast í–ˆì„ ë• ì•„ë¬´ ë¬¸ì œ ì—†ëŠ” ì½”ë“œì˜€ëŠ”ë°...
// (ë¬¼ë¡  Dogì—ë§Œ ìˆëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤ë©´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ)
// ê·¸ëŸ¬ë‚˜ ë™ì  ìºìŠ¤íŒ…ì€.. ë„ˆ Dogê°€ ì•„ë‹Œë°..? Dogì´ ë‹ˆ ë¶€ëª¨ë„ ì•„ë‹ˆê³ ..? NULL ë°˜í™˜í•¨.


// ì»´íŒŒì¼ ê°€ëŠ¥, í•˜ì§€ë§Œ GetHouseName() í•¨ìˆ˜ í˜¸ì¶œ ì•ˆ ë¨. ifì—ì„œ ê±¸ë ¤ì„œ.
if (myDog != NULL)
{
  myDog->GetHouseName();
}
```

### 4-1. static_cast vs dynamic_cast

```cpp
// static_cast

Animal* myPet = new Cat();

// ì»´íŒŒì¼ ë¨. Animal-Dog ê³¼ì˜ ê´€ê³„ë§Œ ì²´í¬í•˜ë¯€ë¡œ.
Dog* myDog = static_cast<Dog*>(myPet);

// ì»´íŒŒì¼ ë¨. í•˜ì§€ë§Œ ì–´ë–»ê²Œ ë™ì‘í• ì§€ ëª¨ë¦„. í¬ë˜ì‹œ ë‚  ê°€ëŠ¥ì„± ìˆìŒ.
myDog->GetHouseName();
```

```cpp
// dynamic_cast

Animal* myPet = new Cat();

// ì»´íŒŒì¼ ë¨. ê·¸ë¦¬ê³  ì–¸ì œë‚˜ NULLì„ ë°˜í™˜
Dog* myDog = dynamic_cast<Dog*>(myPet);

// ì»´íŒŒì¼ ë¨. GetHouseName()ì€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ. ifì—ì„œ ê±¸ë ¤ì„œ
if (myDog != NULL)
{
  myDog->GetHouseName();
}
```

## 5. ìºìŠ¤íŒ… ê·œì¹™

- ê¸°ë³¸ì ìœ¼ë¡œ <b>static_cast</b>ë¥¼ ì“¸ ê²ƒ
  - reinterpret_cast<Cat*> ëŒ€ì‹  static_cast<Cat*>ì„ ì“°ë©´ ì»´íŒŒì¼ ì—ëŸ¬ í™•ì¸ ê°€ëŠ¥í•˜ë‹ˆê¹Œ
- í•„ìš”í•  ë•Œë§Œ reinterpret_castë¥¼ ì“¸ ê²ƒ
  - í¬ì¸í„°ì™€ ë¹„í¬ì¸í„° ì‚¬ì´ì˜ ë³€í™˜
  - ì„œë¡œ ê´€ë ¨ ì—†ëŠ” í¬ì¸í„° ì‚¬ì´ì˜ ë³€í™˜ì€ ê·¸ ë°ì´í„°í˜•ì´ ë§ë‹¤ê³  ì •ë§ í™•ì‹ í•  ë•Œ ì‚¬ìš©í•  ê²ƒ
- ë‚´ê°€ ë³€ê²½ ê¶Œí•œì´ ì—†ëŠ” ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í˜¸ì¶œí•  ë•Œë§Œ const_castë¥¼ ì“¸ ê²ƒ